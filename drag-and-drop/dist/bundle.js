!function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);class n{constructor(e,t,r,n){this.insertPosition=r,this.templateEl=document.getElementById(e),this.rootEl=document.getElementById(t);const s=document.importNode(this.templateEl.content,!0);this.element=s.firstElementChild,this.element.id=n||"",this.attach()}attach(){this.rootEl.insertAdjacentElement(this.insertPosition,this.element)}}function s(e,t,r){const n=r.value;return{configurable:!0,get(){return n.bind(this)}}}var i;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(i||(i={}));class o{constructor(e,t,r,n,s){this.id=e,this.title=t,this.description=r,this.people=n,this.status=s}}class l extends class{constructor(){this.listeners=[]}addListeners(e){this.listeners.push(e)}}{constructor(){super(),this.projects=[]}static getInstance(){return this.instance?this.instance:new l}addProject(e,t,r){const n=new o(Math.random().toString(),e,t,r,i.Active);this.projects.push(n),this.updateListeners()}moveProject(e,t){const r=this.projects.find(t=>t.id===e);r&&r.status!==t&&(r.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const a=l.getInstance();var c=function(e,t,r,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,r,o):s(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o};class d extends n{constructor(){super("project-input","app","afterbegin","user-input"),this.inputDesc=document.getElementById("description"),this.inputPeople=document.getElementById("people"),this.inputTitle=document.querySelector("#title"),this.configure()}configure(){this.element.addEventListener("submit",this.handleSubmit)}fillContent(){}clearInputs(){this.inputTitle.value=this.inputDesc.value=this.inputPeople.value=""}gatherInputs(){const e=this.inputTitle.value,t=this.inputDesc.value,r=this.inputPeople.value;return this.clearInputs(),[e.trim(),t.trim(),r.trim()].some(e=>""===e)?void alert("Invalid input!! Please try again"):[e,t,+r]}handleSubmit(e){e.preventDefault();const t=this.gatherInputs();Array.isArray(t)&&a.addProject(...t)}}c([s],d.prototype,"handleSubmit",null);var u=function(e,t,r,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,r,o):s(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o};class p extends n{constructor(e,t){super("single-project",e,"beforeend",t.id),this.project=t,this.configure(),this.fillContent()}get persons(){return this.project.people+" person(s) assigned"}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragStopHandler(e){}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragStopHandler)}fillContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons,this.element.querySelector("p").textContent=this.project.description}}u([s],p.prototype,"dragStartHandler",null);var h=function(e,t,r,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,r,o):s(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o};class f extends n{constructor(e){super("project-list","app","beforeend",e+"-projects"),this.type=e,this.assignedProjects=[],this.configure(),this.fillContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const t=e.dataTransfer.getData("text/plain");a.moveProject(t,"active"===this.type?i.Active:i.Finished)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}renderProject(){document.getElementById(this.type+"-projects-list").innerHTML="";for(const e of this.assignedProjects)new p(this.element.querySelector("ul").id,e)}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),a.addListeners(e=>{this.assignedProjects=e.filter(e=>"active"===this.type?e.status===i.Active:e.status===i.Finished),this.renderProject()})}fillContent(){const e=this.type+"-projects-list";this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" Projects"}}h([s],f.prototype,"dragOverHandler",null),h([s],f.prototype,"dropHandler",null),h([s],f.prototype,"dragLeaveHandler",null),new d,new f("active"),new f("finished")}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYmFzZS1jb21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2RlY29yYXRvcnMvYXV0b2JpbmQudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vZGVscy9wcm9qZWN0LnRzIiwid2VicGFjazovLy8uL3NyYy9zdGF0ZS9wcm9qZWN0LXN0YXRlLnRzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaW5wdXQudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvcHJvamVjdC1pdGVtLnRzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtbGlzdC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvYXBwLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiQ29tcG9uZW50IiwidGVtcGxhdGVJZCIsInJvb3RJZCIsImluc2VydFBvc2l0aW9uIiwibmV3RWxlbWVudElkIiwidGhpcyIsInRlbXBsYXRlRWwiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwicm9vdEVsIiwiaW1wb3J0ZWROb2RlIiwiaW1wb3J0Tm9kZSIsImNvbnRlbnQiLCJlbGVtZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJpZCIsImF0dGFjaCIsImluc2VydEFkamFjZW50RWxlbWVudCIsIkF1dG9iaW5kIiwiXyIsIl8yIiwiZGVzY3JpcHRpb24iLCJib3VuZE1ldGhvZCIsImNvbmZpZ3VyYWJsZSIsIlN0YXR1cyIsIlByb2plY3QiLCJ0aXRsZSIsInBlb3BsZSIsInN0YXR1cyIsImxpc3RlbmVycyIsImZuIiwicHVzaCIsInN1cGVyIiwicHJvamVjdHMiLCJpbnN0YW5jZSIsIm5ld1Byb2plY3QiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJBY3RpdmUiLCJ1cGRhdGVMaXN0ZW5lcnMiLCJwcm9qSWQiLCJuZXdTdGF0dXMiLCJwcm9qZWN0IiwiZmluZCIsInByaiIsInNsaWNlIiwicHJvamVjdFN0YXRlIiwiZ2V0SW5zdGFuY2UiLCJpbnB1dERlc2MiLCJpbnB1dFBlb3BsZSIsImlucHV0VGl0bGUiLCJxdWVyeVNlbGVjdG9yIiwiY29uZmlndXJlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImhhbmRsZVN1Ym1pdCIsInRpdGxlVmFsdWUiLCJkZXNjVmFsdWUiLCJwZW9wbGVWYWx1ZSIsImNsZWFySW5wdXRzIiwidHJpbSIsInNvbWUiLCJlbCIsImFsZXJ0IiwiZSIsInByZXZlbnREZWZhdWx0IiwidXNlcklucHV0IiwiZ2F0aGVySW5wdXRzIiwiQXJyYXkiLCJpc0FycmF5IiwiYWRkUHJvamVjdCIsImZpbGxDb250ZW50IiwiZXZlbnQiLCJkYXRhVHJhbnNmZXIiLCJzZXREYXRhIiwiZWZmZWN0QWxsb3dlZCIsImRyYWdTdGFydEhhbmRsZXIiLCJkcmFnU3RvcEhhbmRsZXIiLCJ0ZXh0Q29udGVudCIsInBlcnNvbnMiLCJ0eXBlIiwiYXNzaWduZWRQcm9qZWN0cyIsInR5cGVzIiwiY2xhc3NMaXN0IiwiYWRkIiwiZ2V0RGF0YSIsIm1vdmVQcm9qZWN0IiwiRmluaXNoZWQiLCJyZW1vdmUiLCJpbm5lckhUTUwiLCJpdGVtIiwiZHJhZ092ZXJIYW5kbGVyIiwiZHJhZ0xlYXZlSGFuZGxlciIsImRyb3BIYW5kbGVyIiwiYWRkTGlzdGVuZXJzIiwiZmlsdGVyIiwicmVuZGVyUHJvamVjdCIsImxpc3RJZCIsInRvVXBwZXJDYXNlIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BCLEdBQVcsRUFBUEUsR0FBOEIsaUJBQVZGLEdBQXNCQSxHQUFTQSxFQUFNRyxXQUFZLE9BQU9ILEVBQ2hGLElBQUlJLEVBQUtYLE9BQU9ZLE9BQU8sTUFHdkIsR0FGQTFCLEVBQW9Ca0IsRUFBRU8sR0FDdEJYLE9BQU9DLGVBQWVVLEVBQUksVUFBVyxDQUFFVCxZQUFZLEVBQU1LLE1BQU9BLElBQ3RELEVBQVBFLEdBQTRCLGlCQUFU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Q0N4QkwsSUFBSSxFQUNKLElBQUksRUFBWSxVQUNoQixJQUFJLEVBQVkiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiZXhwb3J0IGFic3RyYWN0IGNsYXNzIENvbXBvbmVudDxUIGV4dGVuZHMgSFRNTEVsZW1lbnQsIFUgZXh0ZW5kcyBIVE1MRWxlbWVudD57XHJcblxyXG4gICAgdGVtcGxhdGVFbDogSFRNTFRlbXBsYXRlRWxlbWVudDtcclxuICAgIHJvb3RFbDogVDtcclxuICAgIGVsZW1lbnQ6IFU7XHJcblxyXG4gICAgY29uc3RydWN0b3IodGVtcGxhdGVJZDogc3RyaW5nLCByb290SWQ6IHN0cmluZywgcHVibGljIGluc2VydFBvc2l0aW9uOiBJbnNlcnRQb3NpdGlvbiwgbmV3RWxlbWVudElkPzogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy50ZW1wbGF0ZUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGVtcGxhdGVJZCkhIGFzIEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5yb290RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyb290SWQpISBhcyBUO1xyXG4gICAgICAgIGNvbnN0IGltcG9ydGVkTm9kZSA9IGRvY3VtZW50LmltcG9ydE5vZGUodGhpcy50ZW1wbGF0ZUVsLmNvbnRlbnQsIHRydWUpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGltcG9ydGVkTm9kZS5maXJzdEVsZW1lbnRDaGlsZCBhcyBVO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5pZCA9IG5ld0VsZW1lbnRJZCB8fCAnJztcclxuICAgICAgICB0aGlzLmF0dGFjaCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXR0YWNoKCkge1xyXG4gICAgICAgIHRoaXMucm9vdEVsLmluc2VydEFkamFjZW50RWxlbWVudCh0aGlzLmluc2VydFBvc2l0aW9uLCB0aGlzLmVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIGFic3RyYWN0IGNvbmZpZ3VyZSgpOiB2b2lkO1xyXG4gICAgYWJzdHJhY3QgZmlsbENvbnRlbnQoKTogdm9pZDtcclxufVxyXG4iLCJleHBvcnQgZnVuY3Rpb24gQXV0b2JpbmQoXzogYW55LCBfMjogc3RyaW5nLCBkZXNjcmlwdGlvbjogUHJvcGVydHlEZXNjcmlwdG9yKSB7XHJcbiAgICBjb25zdCBib3VuZE1ldGhvZCA9IGRlc2NyaXB0aW9uLnZhbHVlO1xyXG4gICAgY29uc3QgbmV3RGVzY3JpcHRpb246IFByb3BlcnR5RGVzY3JpcHRvciA9IHtcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgZ2V0KCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYm91bmRNZXRob2QuYmluZCh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmV3RGVzY3JpcHRpb247XHJcbn0iLCJleHBvcnQgZW51bSBTdGF0dXMgeyBBY3RpdmUsIEZpbmlzaGVkIH07XHJcblxyXG5leHBvcnQgY2xhc3MgUHJvamVjdCB7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwdWJsaWMgaWQ6IHN0cmluZyxcclxuICAgICAgICBwdWJsaWMgdGl0bGU6IHN0cmluZyxcclxuICAgICAgICBwdWJsaWMgZGVzY3JpcHRpb246IHN0cmluZyxcclxuICAgICAgICBwdWJsaWMgcGVvcGxlOiBudW1iZXIsXHJcbiAgICAgICAgcHVibGljIHN0YXR1czogU3RhdHVzXHJcbiAgICApIHsgfVxyXG59IiwiaW1wb3J0IHsgUHJvamVjdCwgU3RhdHVzIH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCI7XHJcblxyXG4vL1N0YXRlIE1hbmFnZW1lbnRcclxudHlwZSBMaXN0ZW5lcnM8VD4gPSAoaXRlbXM6IFRbXSkgPT4gdm9pZFxyXG5cclxuY2xhc3MgU3RhdGU8VD57XHJcbiAgICBwcm90ZWN0ZWQgbGlzdGVuZXJzOiBMaXN0ZW5lcnM8VD5bXSA9IFtdO1xyXG4gICAgYWRkTGlzdGVuZXJzKGZuOiBMaXN0ZW5lcnM8VD4pIHtcclxuICAgICAgICB0aGlzLmxpc3RlbmVycy5wdXNoKGZuKTtcclxuICAgIH1cclxufVxyXG5cclxuY2xhc3MgUHJvamVjdFN0YXRlIGV4dGVuZHMgU3RhdGU8UHJvamVjdD4ge1xyXG4gICAgcHJpdmF0ZSBwcm9qZWN0czogUHJvamVjdFtdID0gW107XHJcbiAgICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogUHJvamVjdFN0YXRlO1xyXG4gICAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpXHJcbiAgICB9XHJcbiAgICBzdGF0aWMgZ2V0SW5zdGFuY2UoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaW5zdGFuY2UpIHJldHVybiB0aGlzLmluc3RhbmNlO1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvamVjdFN0YXRlKCk7XHJcbiAgICB9XHJcbiAgICBhZGRQcm9qZWN0KHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIHBlb3BsZTogbnVtYmVyKSB7XHJcbiAgICAgICAgY29uc3QgbmV3UHJvamVjdCA9IG5ldyBQcm9qZWN0KE1hdGgucmFuZG9tKCkudG9TdHJpbmcoKSwgdGl0bGUsIGRlc2NyaXB0aW9uLCBwZW9wbGUsIFN0YXR1cy5BY3RpdmUpXHJcbiAgICAgICAgdGhpcy5wcm9qZWN0cy5wdXNoKG5ld1Byb2plY3QpO1xyXG4gICAgICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbW92ZVByb2plY3QocHJvaklkOiBzdHJpbmcsIG5ld1N0YXR1czogU3RhdHVzKSB7XHJcbiAgICAgICAgY29uc3QgcHJvamVjdCA9IHRoaXMucHJvamVjdHMuZmluZChwcmogPT4gcHJqLmlkID09PSBwcm9qSWQpO1xyXG4gICAgICAgIGlmIChwcm9qZWN0ICYmIHByb2plY3Quc3RhdHVzICE9PSBuZXdTdGF0dXMpIHtcclxuICAgICAgICAgICAgcHJvamVjdC5zdGF0dXMgPSBuZXdTdGF0dXM7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgdXBkYXRlTGlzdGVuZXJzKCkge1xyXG4gICAgICAgIGZvciAoY29uc3QgZm4gb2YgdGhpcy5saXN0ZW5lcnMpIHtcclxuICAgICAgICAgICAgZm4odGhpcy5wcm9qZWN0cy5zbGljZSgpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcHJvamVjdFN0YXRlID0gUHJvamVjdFN0YXRlLmdldEluc3RhbmNlKCk7XHJcbiIsImltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4vYmFzZS1jb21wb25lbnQnXHJcbmltcG9ydCB7IEF1dG9iaW5kIH0gZnJvbSAnLi4vZGVjb3JhdG9ycy9hdXRvYmluZCc7XHJcbmltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL3Byb2plY3Qtc3RhdGUnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3RJbnB1dCBleHRlbmRzIENvbXBvbmVudDxIVE1MRGl2RWxlbWVudCwgSFRNTEZvcm1FbGVtZW50PntcclxuICAgIGlucHV0VGl0bGU6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBpbnB1dERlc2M6IEhUTUxUZXh0QXJlYUVsZW1lbnQ7XHJcbiAgICBpbnB1dFBlb3BsZTogSFRNTElucHV0RWxlbWVudDtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCdwcm9qZWN0LWlucHV0JywgJ2FwcCcsICdhZnRlcmJlZ2luJywgJ3VzZXItaW5wdXQnKVxyXG4gICAgICAgIHRoaXMuaW5wdXREZXNjID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rlc2NyaXB0aW9uJykhIGFzIEhUTUxUZXh0QXJlYUVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5pbnB1dFBlb3BsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwZW9wbGUnKSEgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICB0aGlzLmlucHV0VGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdGl0bGUnKSEgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbmZpZ3VyZSgpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5oYW5kbGVTdWJtaXQpXHJcbiAgICB9XHJcblxyXG4gICAgZmlsbENvbnRlbnQoKSB7IH1cclxuXHJcbiAgICBwcml2YXRlIGNsZWFySW5wdXRzKCkge1xyXG4gICAgICAgIHRoaXMuaW5wdXRUaXRsZS52YWx1ZSA9IHRoaXMuaW5wdXREZXNjLnZhbHVlID0gdGhpcy5pbnB1dFBlb3BsZS52YWx1ZSA9ICcnXHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnYXRoZXJJbnB1dHMoKTogW3N0cmluZywgc3RyaW5nLCBudW1iZXJdIHwgdW5kZWZpbmVkIHtcclxuICAgICAgICBjb25zdCB0aXRsZVZhbHVlID0gdGhpcy5pbnB1dFRpdGxlLnZhbHVlO1xyXG4gICAgICAgIGNvbnN0IGRlc2NWYWx1ZSA9IHRoaXMuaW5wdXREZXNjLnZhbHVlO1xyXG4gICAgICAgIGNvbnN0IHBlb3BsZVZhbHVlID0gdGhpcy5pbnB1dFBlb3BsZS52YWx1ZTtcclxuICAgICAgICB0aGlzLmNsZWFySW5wdXRzKClcclxuICAgICAgICBpZiAoW3RpdGxlVmFsdWUudHJpbSgpLCBkZXNjVmFsdWUudHJpbSgpLCBwZW9wbGVWYWx1ZS50cmltKCldLnNvbWUoZWwgPT4gZWwgPT09ICcnKSkge1xyXG4gICAgICAgICAgICBhbGVydCgnSW52YWxpZCBpbnB1dCEhIFBsZWFzZSB0cnkgYWdhaW4nKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbdGl0bGVWYWx1ZSwgZGVzY1ZhbHVlLCArcGVvcGxlVmFsdWVdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBAQXV0b2JpbmRcclxuICAgIHByaXZhdGUgaGFuZGxlU3VibWl0KGU6IEV2ZW50KSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGNvbnN0IHVzZXJJbnB1dCA9IHRoaXMuZ2F0aGVySW5wdXRzKCk7XHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodXNlcklucHV0KSkge1xyXG4gICAgICAgICAgICBwcm9qZWN0U3RhdGUuYWRkUHJvamVjdCguLi51c2VySW5wdXQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgeyBEcmFnZ2FibGUgfSBmcm9tIFwiLi4vbW9kZWxzL2RyYWctZHJvcFwiO1xyXG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tICcuL2Jhc2UtY29tcG9uZW50J1xyXG5pbXBvcnQgeyBQcm9qZWN0IH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCI7XHJcbmltcG9ydCB7IEF1dG9iaW5kIH0gZnJvbSBcIi4uL2RlY29yYXRvcnMvYXV0b2JpbmRcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0SXRlbSBleHRlbmRzIENvbXBvbmVudDxIVE1MVUxpc3RFbGVtZW50LCBIVE1MTElFbGVtZW50PiBpbXBsZW1lbnRzIERyYWdnYWJsZSB7XHJcbiAgICBwcml2YXRlIHByb2plY3Q6IFByb2plY3Q7XHJcbiAgICBnZXQgcGVyc29ucygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wcm9qZWN0LnBlb3BsZSArICcgcGVyc29uKHMpIGFzc2lnbmVkJztcclxuICAgIH1cclxuICAgIGNvbnN0cnVjdG9yKHJvb3RJZDogc3RyaW5nLCBwcm9qZWN0OiBQcm9qZWN0KSB7XHJcbiAgICAgICAgc3VwZXIoJ3NpbmdsZS1wcm9qZWN0Jywgcm9vdElkLCAnYmVmb3JlZW5kJywgcHJvamVjdC5pZCk7XHJcbiAgICAgICAgdGhpcy5wcm9qZWN0ID0gcHJvamVjdDtcclxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpO1xyXG4gICAgICAgIHRoaXMuZmlsbENvbnRlbnQoKTtcclxuICAgIH1cclxuXHJcbiAgICBAQXV0b2JpbmRcclxuICAgIGRyYWdTdGFydEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuc2V0RGF0YSgndGV4dC9wbGFpbicsIHRoaXMucHJvamVjdC5pZCk7XHJcbiAgICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5lZmZlY3RBbGxvd2VkID0gJ21vdmUnO1xyXG4gICAgfVxyXG5cclxuICAgIGRyYWdTdG9wSGFuZGxlcihfOiBEcmFnRXZlbnQpOiB2b2lkIHsgfVxyXG5cclxuICAgIGNvbmZpZ3VyZSgpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgdGhpcy5kcmFnU3RhcnRIYW5kbGVyKVxyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgdGhpcy5kcmFnU3RvcEhhbmRsZXIpXHJcbiAgICB9XHJcblxyXG4gICAgZmlsbENvbnRlbnQoKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyJykhLnRleHRDb250ZW50ID0gdGhpcy5wcm9qZWN0LnRpdGxlO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMycpIS50ZXh0Q29udGVudCA9IHRoaXMucGVyc29ucztcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigncCcpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdC5kZXNjcmlwdGlvbjtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgeyBEcmFnVGFyZ2V0IH0gZnJvbSBcIi4uL21vZGVscy9kcmFnLWRyb3BcIjtcclxuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9iYXNlLWNvbXBvbmVudCdcclxuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSBcIi4uL3N0YXRlL3Byb2plY3Qtc3RhdGVcIjtcclxuaW1wb3J0ICogYXMgUCBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcclxuaW1wb3J0IHsgQXV0b2JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9hdXRvYmluZFwiO1xyXG5pbXBvcnQgeyBQcm9qZWN0SXRlbSB9IGZyb20gXCIuL3Byb2plY3QtaXRlbVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3RMaXN0IGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRWxlbWVudD4gaW1wbGVtZW50cyBEcmFnVGFyZ2V0IHtcclxuICAgIGFzc2lnbmVkUHJvamVjdHM6IFAuUHJvamVjdFtdID0gW107XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB0eXBlOiAnYWN0aXZlJyB8ICdmaW5pc2hlZCcpIHtcclxuICAgICAgICBzdXBlcigncHJvamVjdC1saXN0JywgJ2FwcCcsICdiZWZvcmVlbmQnLCBgJHt0eXBlfS1wcm9qZWN0c2ApXHJcbiAgICAgICAgdGhpcy5jb25maWd1cmUoKTtcclxuICAgICAgICB0aGlzLmZpbGxDb250ZW50KCk7XHJcbiAgICB9XHJcbiAgICBAQXV0b2JpbmRcclxuICAgIGRyYWdPdmVySGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZCB7XHJcbiAgICAgICAgaWYgKGV2ZW50LmRhdGFUcmFuc2ZlciAmJiBldmVudC5kYXRhVHJhbnNmZXIudHlwZXNbMF0gPT09ICd0ZXh0L3BsYWluJykge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSEuY2xhc3NMaXN0LmFkZCgnZHJvcHBhYmxlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgQEF1dG9iaW5kXHJcbiAgICBkcm9wSGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgcHJvaklkID0gZXZlbnQuZGF0YVRyYW5zZmVyIS5nZXREYXRhKCd0ZXh0L3BsYWluJyk7XHJcbiAgICAgICAgcHJvamVjdFN0YXRlLm1vdmVQcm9qZWN0KHByb2pJZCwgdGhpcy50eXBlID09PSAnYWN0aXZlJyA/IFAuU3RhdHVzLkFjdGl2ZSA6IFAuU3RhdHVzLkZpbmlzaGVkKVxyXG4gICAgfVxyXG4gICAgQEF1dG9iaW5kXHJcbiAgICBkcmFnTGVhdmVIYW5kbGVyKF86IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIS5jbGFzc0xpc3QucmVtb3ZlKCdkcm9wcGFibGUnKVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVuZGVyUHJvamVjdCgpIHtcclxuICAgICAgICBjb25zdCBsaXN0RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHt0aGlzLnR5cGV9LXByb2plY3RzLWxpc3RgKSEgYXMgSFRNTFVMaXN0RWxlbWVudDtcclxuICAgICAgICBsaXN0RWwuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHRoaXMuYXNzaWduZWRQcm9qZWN0cykge1xyXG4gICAgICAgICAgICBuZXcgUHJvamVjdEl0ZW0odGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkLCBpdGVtKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uZmlndXJlKCkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIHRoaXMuZHJhZ092ZXJIYW5kbGVyKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2xlYXZlJywgdGhpcy5kcmFnTGVhdmVIYW5kbGVyKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIHRoaXMuZHJvcEhhbmRsZXIpO1xyXG4gICAgICAgIHByb2plY3RTdGF0ZS5hZGRMaXN0ZW5lcnMoKHByb2plY3RzOiBQLlByb2plY3RbXSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmFzc2lnbmVkUHJvamVjdHMgPSBwcm9qZWN0cy5maWx0ZXIocHJqID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnR5cGUgPT09ICdhY3RpdmUnKSByZXR1cm4gcHJqLnN0YXR1cyA9PT0gUC5TdGF0dXMuQWN0aXZlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHByai5zdGF0dXMgPT09IFAuU3RhdHVzLkZpbmlzaGVkO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJQcm9qZWN0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZmlsbENvbnRlbnQoKSB7XHJcbiAgICAgICAgY29uc3QgbGlzdElkID0gYCR7dGhpcy50eXBlfS1wcm9qZWN0cy1saXN0YDtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSEuaWQgPSBsaXN0SWQ7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyJykhLnRleHRDb250ZW50ID0gdGhpcy50eXBlLnRvVXBwZXJDYXNlKCkgKyAnIFByb2plY3RzJ1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgUHJvamVjdElucHV0IH0gZnJvbSAnLi9jb21wb25lbnRzL3Byb2plY3QtaW5wdXQnO1xyXG5pbXBvcnQgeyBQcm9qZWN0TGlzdCB9IGZyb20gXCIuL2NvbXBvbmVudHMvcHJvamVjdC1saXN0XCI7XHJcblxyXG5uZXcgUHJvamVjdElucHV0KCk7XHJcbm5ldyBQcm9qZWN0TGlzdCgnYWN0aXZlJyk7XHJcbm5ldyBQcm9qZWN0TGlzdCgnZmluaXNoZWQnKTtcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==